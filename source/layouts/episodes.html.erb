<% wrap_layout :layout do %>
  <div class="page">
    <header>
      <%= partial "partials/header" %>
    </header>
    <div class="content episode">
      <h1><%= current_page.title %></h1>
      <div class="subscribe">
        <%= partial "partials/subscribe" %>
      </div>
      <h2>Listen</h2>
      <audio controls preload="auto" src="<%= cdn_file_url(current_page.data.audio_file_name) %>">
        Your browser does not support the audio element.
      </audio>
      <h2>Show Details</h2>
      <div class="pub-date">
        <span class="label">Episode:</span>&nbsp;
        <%= current_page.data.id %>
      </div>
      <div class="pub-date">
        <span class="label">Published:</span>&nbsp;
        <%= current_page.date.strftime("%A, %B %e, %Y") %>
      </div>
      <div class="featuring">
        <span class="label">Featuring:</span>&nbsp;
        <%= current_page.data.featuring %>
      </div>
      <div class="duration">
        <span class="label">Duration:</span>&nbsp;
        <%= current_page.data.duration %>
      </div>
      <div class="file-size">
        <span class="label">File Size:</span>&nbsp;
        <%= current_page.data.file_size_bytes/1000000 %> MB
      </div>
      <div class="download">
        <span class="label">Download:</span>&nbsp;
        <a href="<%= cdn_file_url(current_page.data.audio_file_name) %>" class="webpage" download>
          Audio File (mp3)
        </a>
      </div>
      <article>
        <%= current_page.body %>
      </article>
    </div><!-- /.content .episode -->
    <footer>
      <%= partial "partials/footer" %>
    </footer>
  </div><!-- /.page -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "AudioObject",
    "contentUrl": "<%= current_page.data.soundcloud_link %>",
    "contentSize": "<%= current_page.data.file_size_bytes %>",
    "uploadDate": "<%= current_page.data.file_size_bytes %>",
    "associatedArticle": "https://www.ctothink.com<%= current_page.url %>",
    "headline": "<%= current_page.title %>",
    "description": "<%= current_page.data.short_description %>",
    "duration": "<%= Time.parse(current_page.data.duration).strftime('T%MM%SS') %>",
    "encodingFormat": "mp3",
    "name": "<%= current_page.data.audio_file_name %>",
    "productionCompany": "<%= config[:author] %>",
    "accountablePerson": "<%= config[:author] %>",
    "author": "<%= config[:author] %>",
    "creator": "<%= config[:author] %>",
    "publisher": "<%= config[:author] %>",
    "copyrightHolder": "<%= config[:author] %>",
    "genre": "<%= config[:genre] %>",
    "isFamilyFriendly": true,
    "keywords": "<%= current_page.data.keywords %>",
    "position": <%= current_page.data.id %>,
    "image": "<%= config[:image_url] %>"
  }
</script>
<% end %>


